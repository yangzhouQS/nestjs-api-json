# APIJSON ORM åŠŸèƒ½å®ç°è®¡åˆ’

## é¡¹ç›®æ¦‚è¿°

åŸºäº NestJS çš„ APIJSON ORM å®ç°ï¼Œå®Œå…¨éµå¾ª APIJSON è¯­æ³•æ ‡å‡†ï¼Œæä¾›å¼ºå¤§çš„æ•°æ®åº“æ“ä½œèƒ½åŠ›ã€‚

## å½“å‰å®ç°çŠ¶æ€

### å·²å®Œæˆ âœ…

1. **åŸºç¡€ç±»å‹å’Œæ¥å£**
   - RequestMethod æšä¸¾ - è¯·æ±‚æ–¹æ³•æšä¸¾ï¼ˆGET, HEAD, GETS, HEADS, POST, PUT, DELETE, CRUDï¼‰
   - Parser æ¥å£ - è§£æå™¨æ¥å£
   - ObjectParser æ¥å£ - å¯¹è±¡è§£æå™¨æ¥å£
   - SQLConfig æ¥å£ - SQLé…ç½®æ¥å£
   - SQLExecutor æ¥å£ - SQLæ‰§è¡Œå™¨æ¥å£
   - Verifier æ¥å£ - éªŒè¯å™¨æ¥å£
   - FunctionParser æ¥å£ - å‡½æ•°è§£æå™¨æ¥å£

2. **æ¨¡å‹ç±»**
   - Join æ¨¡å‹ - JOINè¿æ¥æ¨¡å‹ï¼ˆæ”¯æŒ10ç§JOINç±»å‹ï¼‰
   - Subquery æ¨¡å‹ - å­æŸ¥è¯¢æ¨¡å‹ï¼ˆæ”¯æŒALL/ANYèŒƒå›´ï¼‰

3. **å¼‚å¸¸å¤„ç†**
   - CommonException - åŸºç¡€å¼‚å¸¸ç±»
   - ConditionErrorException - æ¡ä»¶é”™è¯¯å¼‚å¸¸
   - ConflictException - å†²çªå¼‚å¸¸
   - NotExistException - ä¸å­˜åœ¨å¼‚å¸¸
   - NotLoggedInException - æœªç™»å½•å¼‚å¸¸
   - OutOfRangeException - è¶…å‡ºèŒƒå›´å¼‚å¸¸
   - UnsupportedDataTypeException - ä¸æ”¯æŒçš„æ•°æ®ç±»å‹å¼‚å¸¸

4. **è¿ç®—ç¬¦è§£æå™¨**
   - OperatorParser - æ¡ä»¶è¿ç®—ç¬¦è§£æå™¨
     - æ¯”è¾ƒè¿ç®—ç¬¦ï¼ˆ=, !=, >, <, >=, <=, <>ï¼‰
     - é€»è¾‘è¿ç®—ç¬¦ï¼ˆ&, |, !ï¼‰
     - æ¨¡ç³Šè¿ç®—ç¬¦ï¼ˆ$, ~, !~, ?ï¼‰
     - èŒƒå›´è¿ç®—ç¬¦ï¼ˆ{}, !{}, ><, !><ï¼‰
     - æ•°ç»„è¿ç®—ç¬¦ï¼ˆ<>ï¼‰

5. **é…ç½®ç®¡ç†**
   - APIJSONConfig - APIJSONé…ç½®ç±»
     - Parseré…ç½®ï¼ˆåˆ†é¡µã€æŸ¥è¯¢é™åˆ¶ã€æ—¥å¿—ï¼‰
     - SQLConfigé…ç½®ï¼ˆæ•°æ®åº“ã€ç¼“å­˜ï¼‰
     - Verifieré…ç½®ï¼ˆæƒé™éªŒè¯ï¼‰
     - FunctionParseré…ç½®ï¼ˆå‡½æ•°è°ƒç”¨ï¼‰
     - æ•°æ®åº“é…ç½®ï¼ˆ12ç§æ•°æ®åº“ç±»å‹ï¼‰
     - ç¯å¢ƒå˜é‡åŠ è½½æ”¯æŒ

6. **æŠ½è±¡åŸºç±»**
   - AbstractParser - è§£æå™¨æŠ½è±¡ç±»
   - AbstractObjectParser - å¯¹è±¡è§£æå™¨æŠ½è±¡ç±»
   - AbstractSQLConfig - SQLé…ç½®æŠ½è±¡ç±»
   - AbstractSQLExecutor - SQLæ‰§è¡Œå™¨æŠ½è±¡ç±»
   - AbstractVerifier - éªŒè¯å™¨æŠ½è±¡ç±»
   - AbstractFunctionParser - å‡½æ•°è§£æå™¨æŠ½è±¡ç±»

## å¾…å®ç°åŠŸèƒ½

### 1. ç‰¹æ®Šå­—æ®µè§£æå™¨ ğŸ¯

#### 1.1 @column åˆ—é€‰æ‹©è§£æå™¨

**åŠŸèƒ½è¯´æ˜**ï¼š
- æ”¯æŒå­—æ®µé€‰æ‹©ï¼ˆå¦‚ï¼š`"@column":"id,name,age"`ï¼‰
- æ”¯æŒå­—æ®µåˆ«åï¼ˆå¦‚ï¼š`"@column":"id,date:time,content:text"`ï¼‰
- æ”¯æŒSQLå‡½æ•°ï¼ˆå¦‚ï¼š`"@column":"id;max(id):maxId"`ï¼‰
- æ”¯æŒåˆ†å·åˆ†éš”å¤šä¸ªè¡¨è¾¾å¼

**å®ç°æ–‡ä»¶**ï¼š
- `src/core/parsers/column-parser.ts`ï¼ˆå·²å­˜åœ¨ï¼Œéœ€å®Œå–„ï¼‰

**æ ¸å¿ƒæ–¹æ³•**ï¼š
```typescript
parseColumn(column: string): ColumnParseResult
parseAlias(column: string): { field: string, alias: string }
parseFunction(column: string): { function: string, alias: string }
```

**ç¤ºä¾‹**ï¼š
```json
{
  "Moment": {
    "@column": "id,date:time,content:text"
  }
}
```

#### 1.2 @order æ’åºè§£æå™¨

**åŠŸèƒ½è¯´æ˜**ï¼š
- æ”¯æŒå¤šå­—æ®µæ’åº
- æ”¯æŒå‡åºï¼ˆé»˜è®¤ï¼‰å’Œé™åºï¼ˆå­—æ®µååŠ `-`ï¼‰
- æ”¯æŒä¼˜å…ˆçº§ï¼ˆæŒ‰å­—æ®µé¡ºåºï¼‰

**å®ç°æ–‡ä»¶**ï¼š
- `src/core/parsers/order-parser.ts`ï¼ˆå·²å­˜åœ¨ï¼Œéœ€å®Œå–„ï¼‰

**æ ¸å¿ƒæ–¹æ³•**ï¼š
```typescript
parseOrder(order: string): OrderItem[]
toSQLOrder(orderItems: OrderItem[]): string
```

**ç¤ºä¾‹**ï¼š
```json
{
  "[]": {
    "Moment": {
      "@order": "date-,id,content+"
    }
  }
}
```

#### 1.3 @group åˆ†ç»„è§£æå™¨

**åŠŸèƒ½è¯´æ˜**ï¼š
- æ”¯æŒå¤šå­—æ®µåˆ†ç»„
- æ”¯æŒåˆ†ç»„éªŒè¯ï¼ˆå¦‚æœ@columné‡Œæœ‰idï¼Œåˆ™idå¿…é¡»åœ¨@groupä¸­ï¼‰

**å®ç°æ–‡ä»¶**ï¼š
- `src/core/parsers/group-parser.ts`ï¼ˆå·²å­˜åœ¨ï¼Œéœ€å®Œå–„ï¼‰

**æ ¸å¿ƒæ–¹æ³•**ï¼š
```typescript
parseGroup(group: string): string[]
validateGroup(group: string[], column: string[]): void
```

**ç¤ºä¾‹**ï¼š
```json
{
  "[]": {
    "Moment": {
      "@column": "userId;max(id)",
      "@group": "userId"
    }
  }
}
```

#### 1.4 @having åˆ†ç»„è¿‡æ»¤è§£æå™¨

**åŠŸèƒ½è¯´æ˜**ï¼š
- æ”¯æŒèšåˆå‡½æ•°æ¡ä»¶è¿‡æ»¤
- æ”¯æŒå¤šä¸ªæ¡ä»¶ç»„åˆ
- ä¸€èˆ¬ä¸@groupä¸€èµ·ä½¿ç”¨

**å®ç°æ–‡ä»¶**ï¼š
- `src/core/parsers/having-parser.ts`ï¼ˆå·²å­˜åœ¨ï¼Œéœ€å®Œå–„ï¼‰

**æ ¸å¿ƒæ–¹æ³•**ï¼š
```typescript
parseHaving(having: string): HavingCondition[]
toSQLHaving(havingConditions: HavingCondition[]): string
```

**ç¤ºä¾‹**ï¼š
```json
{
  "[]": {
    "Moment": {
      "@column": "userId;max(id):maxId",
      "@group": "userId",
      "@having": "maxId>=100"
    }
  }
}
```

#### 1.5 @combine ç»„åˆæ¡ä»¶è§£æå™¨

**åŠŸèƒ½è¯´æ˜**ï¼š
- æ”¯æŒæ¡ä»¶ç»„åˆæ–¹å¼æŒ‡å®š
- æ”¯æŒé€»è¾‘è¿ç®—ç¬¦ï¼ˆ&, |, !ï¼‰
- è‡ªåŠ¨åˆå¹¶åŒç±»æ¡ä»¶

**å®ç°æ–‡ä»¶**ï¼š
- `src/core/parsers/combine-parser.ts`ï¼ˆå·²å­˜åœ¨ï¼Œéœ€å®Œå–„ï¼‰

**æ ¸å¿ƒæ–¹æ³•**ï¼š
```typescript
parseCombine(combine: string): CombineCondition[]
applyCombine(where: any, combine: CombineCondition[]): any
```

**ç¤ºä¾‹**ï¼š
```json
{
  "User": {
    "name~":"a",
    "tag~":"a",
    "@combine":"name~,tag~"
  }
}
```

#### 1.6 æ•°ç»„å…³é”®è¯è§£æå™¨

**åŠŸèƒ½è¯´æ˜**ï¼š
- `count`: æŸ¥è¯¢æ•°é‡ï¼ˆ0è¡¨ç¤ºæœ€å¤§å€¼ï¼Œé»˜è®¤100ï¼‰
- `page`: æŸ¥è¯¢é¡µç ï¼ˆä»0å¼€å§‹ï¼‰
- `query`: æŸ¥è¯¢å†…å®¹ï¼ˆ0-å¯¹è±¡ï¼Œ1-æ€»æ•°ï¼Œ2-æ•°æ®+æ€»æ•°+åˆ†é¡µï¼‰
- `join`: å¤šè¡¨è¿æ¥æ–¹å¼

**å®ç°æ–‡ä»¶**ï¼š
- `src/core/parsers/pagination-parser.ts`ï¼ˆå·²å­˜åœ¨ï¼Œéœ€å®Œå–„ï¼‰
- `src/core/parsers/join-parser.ts`ï¼ˆæ–°å»ºï¼‰

**æ ¸å¿ƒæ–¹æ³•**ï¼š
```typescript
parseCount(count: number): number
parsePage(page: number): number
parseQuery(query: number): QueryType
parseJoin(join: string): Join[]
```

**ç¤ºä¾‹**ï¼š
```json
{
  "[]": {
    "count": 5,
    "page": 3,
    "query": 2,
    "join": "&/User/id@,</Comment/momentId@",
    "Moment": {}
  }
}
```

### 2. JOINæŸ¥è¯¢æ”¯æŒ ğŸ”—

#### 2.1 JOINè§£æå™¨

**åŠŸèƒ½è¯´æ˜**ï¼š
- è§£æJOINè¯­æ³•
- æ”¯æŒ10ç§JOINç±»å‹
- ç”ŸæˆJOIN SQLè¯­å¥

**å®ç°æ–‡ä»¶**ï¼š
- `src/core/parsers/join-parser.ts`ï¼ˆæ–°å»ºï¼‰

**æ ¸å¿ƒæ–¹æ³•**ï¼š
```typescript
parseJoin(joinString: string): Join[]
toSQLJoin(joins: Join[]): string
```

**JOINç±»å‹**ï¼š
1. APP JOIN (@) - åº”ç”¨å±‚JOIN
2. INNER JOIN (&) - å†…è¿æ¥
3. FULL JOIN (|) - å…¨è¿æ¥
4. LEFT JOIN (<) - å·¦è¿æ¥
5. RIGHT JOIN (>) - å³è¿æ¥
6. OUTER JOIN (!) - å¤–è¿æ¥
7. SIDE JOIN (^) - ä¾§è¿æ¥
8. ANTI JOIN (()
9. FOREIGN JOIN ())
10. ASOF JOIN (~)

**ç¤ºä¾‹**ï¼š
```json
{
  "[]": {
    "join": "&/User/id@,</Comment/momentId@",
    "Moment": {},
    "User": {
      "id@": "/Moment/userId"
    },
    "Comment": {
      "momentId@": "/[]/Moment/id"
    }
  }
}
```

### 3. å­æŸ¥è¯¢åŠŸèƒ½ ğŸ“Š

#### 3.1 å­æŸ¥è¯¢è§£æå™¨

**åŠŸèƒ½è¯´æ˜**ï¼š
- æ”¯æŒWHEREå­æŸ¥è¯¢
- æ”¯æŒFROMå­æŸ¥è¯¢
- æ”¯æŒSELECTå­æŸ¥è¯¢
- æ”¯æŒALL/ANYèŒƒå›´

**å®ç°æ–‡ä»¶**ï¼š
- `src/core/parsers/subquery-parser.ts`ï¼ˆæ–°å»ºï¼‰

**æ ¸å¿ƒæ–¹æ³•**ï¼š
```typescript
parseSubquery(key: string, value: any): Subquery
toSQLSubquery(subquery: Subquery): string
```

**å­æŸ¥è¯¢ç±»å‹**ï¼š
- WHEREå­æŸ¥è¯¢ï¼š`"id@":{"from":"Comment","Comment":{"@column":"min(userId)"}}`
- FROMå­æŸ¥è¯¢ï¼š`"from":"(SELECT * FROM Moment WHERE userId=38710)"`
- SELECTå­æŸ¥è¯¢ï¼š`"@column":"id,(SELECT name FROM User WHERE id=Moment.userId) as userName"`

**ALL/ANYèŒƒå›´**ï¼š
- ALL: `WHERE id > ALL(SELECT userId FROM Comment)`
- ANY: `WHERE id > ANY(SELECT userId FROM Comment)`

**ç¤ºä¾‹**ï¼š
```json
{
  "User": {
    "id@": {
      "from": "Comment",
      "Comment": {
        "@column": "min(userId)"
      }
    }
  }
}
```

### 4. å‡½æ•°è°ƒç”¨åŠŸèƒ½ âš™ï¸

#### 4.1 å‡½æ•°è§£æå™¨

**åŠŸèƒ½è¯´æ˜**ï¼š
- è¿œç¨‹å‡½æ•°è°ƒç”¨
- å­˜å‚¨è¿‡ç¨‹è°ƒç”¨
- è„šæœ¬å‡½æ•°è°ƒç”¨ï¼ˆJavaScript, Lua, Python, Groovyï¼‰

**å®ç°æ–‡ä»¶**ï¼š
- `src/core/parsers/function-parser.ts`ï¼ˆæ–°å»ºï¼‰
- å®Œå–„`src/core/abstract-function-parser.ts`

**æ ¸å¿ƒæ–¹æ³•**ï¼š
```typescript
parseFunction(key: string, value: string): FunctionCall
invokeRemoteFunction(functionName: string, args: any[]): Promise<any>
executeSQLFunction(functionName: string, args: any[]): Promise<any>
executeScriptFunction(script: string, scriptType: string, args: any[]): Promise<any>
```

**å‡½æ•°ç±»å‹**ï¼š
1. è¿œç¨‹å‡½æ•°ï¼š`"isPraised()":"isContain(praiseUserIdList,userId)"`
2. å­˜å‚¨è¿‡ç¨‹ï¼š`"@procedure()":"getCommentByUserId(id,@limit,@offset)"`
3. è„šæœ¬å‡½æ•°ï¼š`"@script()":"javascript:return calculateScore(userId);"`

**ç¤ºä¾‹**ï¼š
```json
{
  "Moment": {
    "id": 301,
    "isPraised()": "isContain(praiseUserIdList,userId)"
  }
}
```

### 5. å¼•ç”¨èµ‹å€¼åŠŸèƒ½ ğŸ”—

#### 5.1 å¼•ç”¨è§£æå™¨

**åŠŸèƒ½è¯´æ˜**ï¼š
- æ”¯æŒkey@å•å€¼å¼•ç”¨
- æ”¯æŒkey{}@æ•°ç»„å¼•ç”¨
- æ”¯æŒè·¯å¾„è§£æ

**å®ç°æ–‡ä»¶**ï¼š
- `src/core/parsers/reference-parser.ts`ï¼ˆæ–°å»ºï¼‰

**æ ¸å¿ƒæ–¹æ³•**ï¼š
```typescript
parseReference(key: string, value: string): Reference
resolveReference(reference: Reference, context: any): any
parsePath(path: string): string[]
getValueByPath(path: string[], context: any): any
```

**å¼•ç”¨ç±»å‹**ï¼š
- å•å€¼å¼•ç”¨ï¼š`"id@":"/Moment/userId"`
- æ•°ç»„å¼•ç”¨ï¼š`"id{}@":"/[]/Moment/id"`
- ç›¸å¯¹è·¯å¾„ï¼š`"/Moment/userId"`ï¼ˆä»çˆ¶å®¹å™¨å¼€å§‹ï¼‰
- ç»å¯¹è·¯å¾„ï¼š`"Moment/userId"`ï¼ˆä»æ ¹å¼€å§‹ï¼‰

**ç¤ºä¾‹**ï¼š
```json
{
  "Moment": {
    "userId": 38710
  },
  "User": {
    "id@": "/Moment/userId"
  }
}
```

### 6. æ•°ç»„æŸ¥è¯¢åŠŸèƒ½ ğŸ“‹

#### 6.1 æ•°ç»„è§£æå™¨

**åŠŸèƒ½è¯´æ˜**ï¼š
- æ”¯æŒTable[]è¡¨æ•°ç»„æŸ¥è¯¢
- æ”¯æŒ[]æ•°ç»„å®¹å™¨æŸ¥è¯¢
- æ”¯æŒæ•°ç»„æå–

**å®ç°æ–‡ä»¶**ï¼š
- `src/core/parsers/array-parser.ts`ï¼ˆæ–°å»ºï¼‰

**æ ¸å¿ƒæ–¹æ³•**ï¼š
```typescript
parseArray(key: string, value: any): ArrayQuery
extractArray(result: any, arrayQuery: ArrayQuery): any[]
```

**æ•°ç»„ç±»å‹**ï¼š
- è¡¨æ•°ç»„ï¼š`"User[]":{"count":3,"User":{}}`
- æ•°ç»„å®¹å™¨ï¼š`"[]":{"count":3,"Moment":{}}`
- æå–æ•°ç»„ï¼š`"User-id[]":{"count":3,"User":{}}`

**ç¤ºä¾‹**ï¼š
```json
{
  "User[]": {
    "count": 3,
    "User": {}
  }
}
```

### 7. èšåˆå‡½æ•°æ”¯æŒ ğŸ“ˆ

#### 7.1 èšåˆå‡½æ•°è§£æå™¨

**åŠŸèƒ½è¯´æ˜**ï¼š
- æ”¯æŒCOUNT, SUM, AVG, MIN, MAX
- æ”¯æŒèšåˆå‡½æ•°åˆ«å
- æ”¯æŒèšåˆå‡½æ•°æ¡ä»¶

**å®ç°æ–‡ä»¶**ï¼š
- `src/core/parsers/aggregate-parser.ts`ï¼ˆæ–°å»ºï¼‰

**æ ¸å¿ƒæ–¹æ³•**ï¼š
```typescript
parseAggregate(function: string): AggregateFunction
toSQLAggregate(aggregate: AggregateFunction): string
```

**èšåˆå‡½æ•°**ï¼š
- COUNT: `COUNT(*)` æˆ– `COUNT(id)`
- SUM: `SUM(amount)`
- AVG: `AVG(score)`
- MIN: `MIN(price)`
- MAX: `MAX(price)`

**ç¤ºä¾‹**ï¼š
```json
{
  "[]": {
    "Moment": {
      "@column": "userId;count(id):count"
    }
  }
}
```

### 8. ç¼“å­˜æœºåˆ¶ ğŸ’¾

#### 8.1 ç¼“å­˜å®ç°

**åŠŸèƒ½è¯´æ˜**ï¼š
- å†…å­˜ç¼“å­˜å®ç°
- Redisç¼“å­˜å®ç°
- ç¼“å­˜è¿‡æœŸç­–ç•¥
- ç¼“å­˜åˆ·æ–°æœºåˆ¶

**å®ç°æ–‡ä»¶**ï¼š
- `src/core/cache/memory-cache.ts`ï¼ˆæ–°å»ºï¼‰
- `src/core/cache/redis-cache.ts`ï¼ˆæ–°å»ºï¼‰
- å®Œå–„`src/core/parsers/cache-parser.ts`

**æ ¸å¿ƒæ–¹æ³•**ï¼š
```typescript
getCache(key: string): Promise<any>
putCache(key: string, value: any, expireTime?: number): Promise<void>
removeCache(key: string): Promise<void>
clearCache(): Promise<void>
```

**ç¼“å­˜é…ç½®**ï¼š
- `@cache`: æ˜¯å¦å¯ç”¨ç¼“å­˜
- `@cacheExpire`: ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰

**ç¤ºä¾‹**ï¼š
```json
{
  "Moment": {
    "id": 12,
    "@cache": true,
    "@cacheExpire": 60
  }
}
```

### 9. äº‹åŠ¡ç®¡ç† ğŸ”„

#### 9.1 äº‹åŠ¡ç®¡ç†å™¨

**åŠŸèƒ½è¯´æ˜**ï¼š
- äº‹åŠ¡å¼€å§‹
- äº‹åŠ¡æäº¤
- äº‹åŠ¡å›æ»š
- ä¿å­˜ç‚¹ç®¡ç†

**å®ç°æ–‡ä»¶**ï¼š
- `src/core/transaction/transaction-manager.ts`ï¼ˆæ–°å»ºï¼‰

**æ ¸å¿ƒæ–¹æ³•**ï¼š
```typescript
begin(): Promise<void>
commit(): Promise<void>
rollback(): Promise<void>
setSavepoint(name: string): Promise<void>
rollbackToSavepoint(name: string): Promise<void>
```

**äº‹åŠ¡ä½¿ç”¨**ï¼š
```typescript
await transactionManager.begin();
try {
  // æ‰§è¡Œå¤šä¸ªæ“ä½œ
  await transactionManager.commit();
} catch (error) {
  await transactionManager.rollback();
  throw error;
}
```

### 10. æ‰¹é‡æ“ä½œ ğŸ“¦

#### 10.1 æ‰¹é‡æ“ä½œå¤„ç†å™¨

**åŠŸèƒ½è¯´æ˜**ï¼š
- æ‰¹é‡æ’å…¥
- æ‰¹é‡æ›´æ–°
- æ‰¹é‡åˆ é™¤

**å®ç°æ–‡ä»¶**ï¼š
- `src/core/batch/batch-processor.ts`ï¼ˆæ–°å»ºï¼‰

**æ ¸å¿ƒæ–¹æ³•**ï¼š
```typescript
batchInsert(table: string, records: any[]): Promise<BatchResult>
batchUpdate(table: string, updates: any[]): Promise<BatchResult>
batchDelete(table: string, ids: any[]): Promise<BatchResult>
```

**æ‰¹é‡æ“ä½œç¤ºä¾‹**ï¼š
```json
{
  "Comment[]": [
    {
      "momentId": 12,
      "content": "Comment 1"
    },
    {
      "momentId": 15,
      "content": "Comment 2"
    }
  ],
  "tag": "Comment:[]"
}
```

### 11. æƒé™æ§åˆ¶ ğŸ”

#### 11.1 æƒé™éªŒè¯å™¨

**åŠŸèƒ½è¯´æ˜**ï¼š
- è§’è‰²éªŒè¯
- è®¿é—®æ§åˆ¶
- å†…å®¹éªŒè¯
- ç™»å½•éªŒè¯

**å®ç°æ–‡ä»¶**ï¼š
- å®Œå–„`src/core/abstract-verifier.ts`
- `src/core/verifier/access-verifier.ts`ï¼ˆæ–°å»ºï¼‰
- `src/core/verifier/role-verifier.ts`ï¼ˆæ–°å»ºï¼‰

**æ ¸å¿ƒæ–¹æ³•**ï¼š
```typescript
verifyLogin(): Promise<void>
verifyRole(role: string): Promise<void>
verifyAccess(table: string, method: RequestMethod): Promise<void>
verifyContent(table: string, content: any): Promise<void>
```

**è§’è‰²ç±»å‹**ï¼š
- UNKNOWN: æœªçŸ¥ç”¨æˆ·
- LOGIN: å·²ç™»å½•ç”¨æˆ·
- CONTACT: è”ç³»äºº
- CIRCLE: åœˆå­
- OWNER: æ‰€æœ‰è€…
- ADMIN: ç®¡ç†å‘˜

**æƒé™é…ç½®**ï¼š
```json
{
  "Moment": {
    "@role": "OWNER"
  }
}
```

## å®ç°ä¼˜å…ˆçº§

### ç¬¬ä¸€é˜¶æ®µï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰
1. âœ… ç‰¹æ®Šå­—æ®µè§£æå™¨ï¼ˆ@column, @order, @group, @having, @combineï¼‰
2. âœ… æ•°ç»„å…³é”®è¯è§£æå™¨ï¼ˆcount, page, query, joinï¼‰
3. âœ… JOINæŸ¥è¯¢æ”¯æŒ
4. âœ… å­æŸ¥è¯¢åŠŸèƒ½
5. âœ… å¼•ç”¨èµ‹å€¼åŠŸèƒ½

### ç¬¬äºŒé˜¶æ®µï¼ˆé«˜çº§åŠŸèƒ½ï¼‰
6. âœ… å‡½æ•°è°ƒç”¨åŠŸèƒ½
7. âœ… æ•°ç»„æŸ¥è¯¢åŠŸèƒ½
8. âœ… èšåˆå‡½æ•°æ”¯æŒ

### ç¬¬ä¸‰é˜¶æ®µï¼ˆä¼˜åŒ–åŠŸèƒ½ï¼‰
9. âœ… ç¼“å­˜æœºåˆ¶
10. âœ… äº‹åŠ¡ç®¡ç†
11. âœ… æ‰¹é‡æ“ä½œ
12. âœ… æƒé™æ§åˆ¶

## æµ‹è¯•è®¡åˆ’

### å•å…ƒæµ‹è¯•
- æ¯ä¸ªè§£æå™¨çš„å•å…ƒæµ‹è¯•
- æ¯ä¸ªåŠŸèƒ½çš„å•å…ƒæµ‹è¯•
- è¾¹ç•Œæ¡ä»¶æµ‹è¯•

### é›†æˆæµ‹è¯•
- å®Œæ•´è¯·æ±‚æµç¨‹æµ‹è¯•
- å¤šè¡¨å…³è”æµ‹è¯•
- å¤æ‚æŸ¥è¯¢æµ‹è¯•

### æ€§èƒ½æµ‹è¯•
- å¤§æ•°æ®é‡æŸ¥è¯¢æµ‹è¯•
- å¹¶å‘è¯·æ±‚æµ‹è¯•
- ç¼“å­˜æ€§èƒ½æµ‹è¯•

## æ–‡æ¡£è®¡åˆ’

1. APIæ–‡æ¡£
2. ä½¿ç”¨æŒ‡å—
3. æœ€ä½³å®è·µ
4. è¿ç§»æŒ‡å—
5. æ•…éšœæ’æŸ¥

## é‡Œç¨‹ç¢‘

- [ ] ç¬¬ä¸€é˜¶æ®µå®Œæˆï¼šæ ¸å¿ƒåŠŸèƒ½å®ç°
- [ ] ç¬¬äºŒé˜¶æ®µå®Œæˆï¼šé«˜çº§åŠŸèƒ½å®ç°
- [ ] ç¬¬ä¸‰é˜¶æ®µå®Œæˆï¼šä¼˜åŒ–åŠŸèƒ½å®ç°
- [ ] æµ‹è¯•å®Œæˆï¼šå•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€æ€§èƒ½æµ‹è¯•
- [ ] æ–‡æ¡£å®Œæˆï¼šAPIæ–‡æ¡£ã€ä½¿ç”¨æŒ‡å—ç­‰
- [ ] å‘å¸ƒç‰ˆæœ¬ï¼šv1.0.0

## æŠ€æœ¯å€ºåŠ¡

1. ä»£ç ä¼˜åŒ–
2. æ€§èƒ½ä¼˜åŒ–
3. é”™è¯¯å¤„ç†å®Œå–„
4. æ—¥å¿—ç³»ç»Ÿå®Œå–„
5. ç›‘æ§ç³»ç»Ÿ

## æ€»ç»“

æœ¬å®ç°è®¡åˆ’æ¶µç›–äº†APIJSON ORMçš„æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ï¼ŒæŒ‰ç…§ä¼˜å…ˆçº§åˆ†é˜¶æ®µå®æ–½ã€‚æ¯ä¸ªåŠŸèƒ½éƒ½æœ‰æ˜ç¡®çš„å®ç°æ–‡ä»¶ã€æ ¸å¿ƒæ–¹æ³•å’Œç¤ºä¾‹ä»£ç ã€‚é€šè¿‡ç³»ç»Ÿçš„å®ç°å’Œæµ‹è¯•ï¼Œæˆ‘ä»¬å°†æä¾›ä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€æ€§èƒ½ä¼˜å¼‚ã€æ˜“äºä½¿ç”¨çš„APIJSON ORMå®ç°ã€‚
