# æ–°å¢æ¥å£

## [#](http://apijson.cn/doc/zh/newinterface.html#åå°æ·»åŠ æ•°æ®è¡¨)åå°æ·»åŠ æ•°æ®è¡¨

åœ¨è‡ªå·±çš„æ•°æ®åº“é‡Œæ–°å¢ä¸€ä¸ªè¡¨ï¼Œæ¯”å¦‚æˆ‘è¿™é‡Œæ–°å¢`b_stone`

```sql
-- åŸçŸ³
CREATE TABLE `b_stone` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `cost` int(10) NULL COMMENT 'æˆæœ¬',
  `price` int(10) NULL COMMENT 'å–ä»·',
  `length` int(10) NULL,
  `width`  int(10) NULL,
  `height` int(10) NULL,
  `weight` float(8,1) NULL,
  `creationdate` datetime default CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  `modifydate` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'ä¿®æ”¹æ—¶é—´',
  `modifier` varchar(80) NULL,
  PRIMARY KEY (`id`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;
```

## [#](http://apijson.cn/doc/zh/newinterface.html#è§’è‰²è®¿é—®æƒé™é…ç½®)è§’è‰²è®¿é—®æƒé™é…ç½®

APIJSON 3.7.0 ç‰ˆå¼€å§‹ï¼Œä¾èµ–äº† apijson-framework.jar çš„ä¸éœ€è¦å†™ä»»ä½•ä»£ç ï¼š

#### [#](http://apijson.cn/doc/zh/newinterface.html#_2-1-åœ¨-access-è¡¨é‡ŒåŠ ä¸€è¡Œè®°å½•å³å¯)2.1ï¼‰åœ¨ Access è¡¨é‡ŒåŠ ä¸€è¡Œè®°å½•å³å¯

![img](./asset/APIJSON_access_config-small.jpg)

å¦‚æœä½äº 3.7.0 æˆ–è€…æœªä¾èµ– apijson-framework.jarï¼Œè€Œæ˜¯ç›´æ¥ä¾èµ– apijson-orm.jarï¼Œåˆ™éœ€è¦ç¼–å†™ä»£ç ï¼š

#### [#](http://apijson.cn/doc/zh/newinterface.html#_2-1-åœ¨modelä¸­æ·»åŠ å¯¹è±¡å¹¶é…ç½®æƒé™)2.1ï¼‰åœ¨Modelä¸­æ·»åŠ å¯¹è±¡å¹¶é…ç½®æƒé™

é¡¹ç›®çš„modelç›®å½•ä¸‹ï¼Œæ–°å¢ä¸€ä¸ªç±»

```java
package apijson.demo.server.model;

import zuo.biao.apijson.MethodAccess;

@MethodAccess
public class Stone {
}
```

æ³¨è§£`@MethodAccess`çš„é…ç½®ï¼Œå¯ä»¥å‚è€ƒå…¶ä»–ç±»

ç”±äºæˆ‘ä»¬çš„ç±»åå’Œæ•°æ®åº“è¡¨åä¸ä¸€è‡´ï¼Œéœ€è¦æ³¨å†Œä¸€ä¸‹ã€‚å¦‚æœä¸€æ ·å°±ä¸éœ€è¦äº†ã€‚

è®¾ç½®æ•°æ®åº“çš„å®é™…è¡¨å`DemoSQLConfig`ï¼Œ38è¡Œ

```java
//è¡¨åæ˜ å°„ï¼Œéšè—çœŸå®è¡¨åï¼Œå¯¹å®‰å…¨è¦æ±‚å¾ˆé«˜çš„è¡¨å¯ä»¥è¿™ä¹ˆåš
	static {
		TABLE_KEY_MAP.put(User.class.getSimpleName(), "apijson_user");
		TABLE_KEY_MAP.put(Privacy.class.getSimpleName(), "apijson_privacy");
		TABLE_KEY_MAP.put(Stone.class.getSimpleName(), "b_stone"); // <--è¿™ä¸€å¥
	}
```

æ³¨å†Œæƒé™æ˜¯å¿…é¡»çš„ï¼Œè¿™æ ·ç¨‹åºæ‰èƒ½ä½¿ç”¨ä½ é…ç½®çš„ç±»æƒé™å»ç®¡ç†ä½ çš„æ¥å£

è„šæœ¬`DemoVerifier.java`çš„48è¡Œ

```java
static { //æ³¨å†Œæƒé™
		ACCESS_MAP.put(User.class.getSimpleName(), getAccessMap(User.class.getAnnotation(MethodAccess.class)));
....
		ACCESS_MAP.put(Stone.class.getSimpleName(), getAccessMap(Stone.class.getAnnotation(MethodAccess.class)));
	}
```

## [#](http://apijson.cn/doc/zh/newinterface.html#è¯·æ±‚å‚æ•°æ ¡éªŒ-request-è¡¨é…ç½®)è¯·æ±‚å‚æ•°æ ¡éªŒ Request è¡¨é…ç½®

![img](./asset/APIJSON_request_config-small.jpg) å¯è¿™æ ·è®¾ç½® structure å­—æ®µæ¥é…ç½®è‡ªåŠ¨æ ¡éªŒè¯·æ±‚ JSON å‚æ•°ï¼š

```json
"VERIFY":{
  "type{}":[0,1,2]
}
```

å°±èƒ½æ ¡éªŒ type çš„å€¼æ˜¯ä¸æ˜¯ 0ï¼Œ1ï¼Œ2ä¸­çš„ä¸€ä¸ªã€‚
è¿˜æœ‰

```js
"VERIFY": { "money&{}":">0,<=10000" }              //è‡ªåŠ¨éªŒè¯æ˜¯å¦ money>0 & money<=10000
"TYPE": { "balance": "Double" }                    //è‡ªåŠ¨éªŒè¯balanceç±»å‹æ˜¯å¦ä¸ºDouble
"UNIQUE": "phone"                                  //å¼ºåˆ¶phoneçš„å€¼ä¸ºæ•°æ®åº“ä¸­æ²¡æœ‰çš„
"NECESSARY": "id,name"                             //å¼ºåˆ¶ä¼ id,nameä¸¤ä¸ªå­—æ®µ
"DISALLOW": "balance"                              //ç¦æ­¢ä¼ balanceå­—æ®µ
"INSERT": { "@role": "OWNER" }                     //å¦‚æœæ²¡ä¼ @roleå°±è‡ªåŠ¨æ·»åŠ 
"UPDATE": { "id@": "User/id" }                     //å¼ºåˆ¶æ”¾å…¥é”®å€¼å¯¹
```

å…¨éƒ¨æ“ä½œç¬¦è§ [Operation.java (opens new window)](https://github.com/Tencent/APIJSON/blob/master/APIJSONORM/src/main/java/apijson/orm/Operation.java)çš„æ³¨é‡Š



ğŸŒ›æ­¤å¤„çš„ä»‹ç»éƒ½åªæ˜¯ç®€è¦ä»‹ç»ï¼Œåªæ˜¯ä¸ºäº†å¼•å¯¼åˆšåˆšæ¥è§¦ APIJSON çš„é“å‹å¿«é€Ÿäº†è§£ APIJSONï¼Œå¹¶ä¸ä»£è¡¨ APIJSON åªæœ‰è¿™äº›åŠŸèƒ½ï¼Œå…·ä½“åŠŸèƒ½è¯¦æƒ…å‚è€ƒä¸‹åˆ—å›¾è¡¨

#### [#](http://apijson.cn/doc/zh/newinterface.html#å®Œæ•´åŠŸèƒ½å›¾è¡¨)å®Œæ•´åŠŸèƒ½å›¾è¡¨

https://github.com/Tencent/APIJSON/blob/master/Document.md#3
